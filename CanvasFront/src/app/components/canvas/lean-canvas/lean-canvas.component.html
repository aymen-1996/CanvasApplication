<div class="bloc">
    <div class="element-bmc">
      <div class="header">

        <div class="css-1t1eosl">
          <div class="css-1ir47a1">
            <a routerLink="/projects" class="no-underline">
              <h2 class="logo"><span style="color: rgb(33, 150, 243)">Canvas</span></h2>
            </a>    <div class="MuiBox-root css-i9gxme"></div>
  
           
            <div class="css-1x4nai">
            <button routerLink="/canvas" class="css-10ygcul" tabindex="0" 
              type="button" title="Canvas"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-0 iconify iconify--codicon" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16">
                <path fill="currentColor" d="M13.5 2h-12l-.5.5v11l.5.5h12l.5-.5v-11zM2 3h11v1H2zm7 4H6V5h3zm0 1v2H6V8zM2 5h3v2H2zm0 3h3v2H2zm0 5v-2h3v2zm4 0v-2h3v2zm7 0h-3v-2h3zm0-3h-3V8h3zm-3-3V5h3v2z">
  
                </path>
              </svg>
                <span class=" css-w0pj6f"></span></button>     
                         <mat-form-field class="custom-select">
                <mat-label>Projet actuel</mat-label>
                <mat-select [(ngModel)]="currentProject">
                  <mat-option>Mes projet</mat-option>
                  <mat-option *ngFor="let project of projects" [value]="project" (click)="navigateToLean(project)">
                    {{ project.nomProjet }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
  
              <mat-icon 
              routerLink="/chat" 
              class="maticon1" 
              matBadge="{{ messageCount }}" 
              matBadgeColor="warn" 
              matBadgePosition="above after" 
              [matBadgeHidden]="messageCount === 0"> 
              chat
            </mat-icon>
  
              <div class="dropdown-container">
  
                <button class="css-tfolz5" tabindex="0" type="button" (click)="togglePendingInvitesDropdown()">
                  <span class="BaseBadge-root MuiBadge-root css-1rzb3uu">
                    <svg 
                    [ngStyle]="{'fill': showPendingInvitesDropdown ? 'rgb(33, 150, 243)' : 'currentColor'}"
                    xmlns="http://www.w3.org/2000/svg" 
                    xmlns:xlink="http://www.w3.org/1999/xlink" 
                    aria-hidden="true" 
                    role="img" 
                    class="MuiBox-root css-1wl1iil iconify iconify--ant-design" 
                    width="1em" 
                    height="1em" 
                    preserveAspectRatio="xMidYMid meet" 
                    viewBox="0 0 1024 1024">
                    <path 
                      [ngStyle]="{'fill': showPendingInvitesDropdown ? 'rgb(33, 150, 243)' : 'currentColor'}" 
                      fill-opacity=".15" 
                      d="M477.5 536.3L135.9 270.7l-27.5-21.4l27.6 21.5V792h752V270.8L546.2 536.3a55.99 55.99 0 0 1-68.7 0">
                    </path>
                    <path 
                      [ngStyle]="{'fill': showPendingInvitesDropdown ? 'rgb(33, 150, 243)' : 'currentColor'}" 
                      fill-opacity=".15" 
                      d="m876.3 198.8l39.3 50.5l-27.6 21.5l27.7-21.5l-39.3-50.5z">
                    </path>
                    <path 
                      [ngStyle]="{'fill': showPendingInvitesDropdown ? 'rgb(33, 150, 243)' : 'currentColor'}" 
                      d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32m-94.5 72.1L512 482L190.5 232.1zm54.5 38.7V792H136V270.8l-27.6-21.5l27.5 21.4l341.6 265.6a55.99 55.99 0 0 0 68.7 0zl27.6-21.5l-39.3-50.5h.1l39.3 50.5z">
                    </path>
                  </svg>
                  
                  <span class="BaseBadge-badge BaseBadge-invisible MuiBadge-badge MuiBadge-standard MuiBadge-invisible MuiBadge-anchorOriginTopRight MuiBadge-anchorOriginTopRightRectangular MuiBadge-overlapRectangular MuiBadge-colorError css-1kr17ld">0</span></span>
                  <span class="MuiTouchRipple-root css-w0pj6f"></span>
                </button>
                        <div *ngIf="pendingInvitesCount > 0" class="badge">{{ pendingInvitesCount }}</div>
  
              </div >
              
              <div *ngIf="showPendingInvitesDropdown" class="css-1oknx5t">
                <span class="arrow css-98b6ta"></span>
                <div class="MuiBox-root css-3sojac">
                  <div class="MuiBox-root css-i9gxme">
                    <h6 class="MuiTypography-root MuiTypography-subtitle1 css-k9tjo5">Invitations</h6>
                    <p class="MuiTypography-root MuiTypography-body2 css-11r9ii4">Vous avez {{ pendingInvitesCount }} invitations</p>
                    <hr class="MuiDivider-root MuiDivider-fullWidth css-zg4d8h">
                    <div class="scroll-container">
                      <div class="css-jjtu05">
                        <div data-simplebar="init" class="css-qw2e6q">
                      <ul class="css-1uzmcsd">
                          <ng-container *ngIf="pendingInvites && pendingInvites.length > 0">
                            <li *ngFor="let invite of pendingInvites" class="css-12ujxra" (click)="openPopup1(invite.idInvite , invite)" tabindex="0" role="button">
                              <div class="css-k008qs" style="display: flex; align-items: center;">
                                  <img alt="User Avatar" [src]="projectImages[invite.projet.idProjet]" style="width: 60px; object-fit: cover; margin-right: 1em;">
                                  <small class="justified-text">
                                    <p><strong>{{ invite.projet.user.nomUser }}</strong> vous a envoyé une invitation pour rejoindre le projet <strong>{{ invite.projet.nomProjet }}</strong> dans <strong>{{ invite.canvas.nomCanvas }}</strong> en tant que <strong>{{ invite.roleInvite }}</strong>.</p>
                                </small>                              
                              </div>
                              <span class="MuiTouchRipple-root css-w0pj6f"></span>
                          </li>
                        </ng-container>
                      </ul>
                    </div>
                    </div>
                    </div>
                  </div>
                </div>
                <hr class="MuiDivider-root MuiDivider-fullWidth css-zg4d8h">
           
                </div>
              
              <div>
        <button class="css-tfolz51" tabindex="0" type="button"  (click)="toggleDropdown1()"><span class=" css-1rzb3uu">
          <svg 
          [ngStyle]="{'fill': isDropdownVisible ? 'rgb(33, 150, 243)' : 'currentColor'}" 
          xmlns="http://www.w3.org/2000/svg" 
          aria-hidden="true" 
          role="img" 
          class="MuiBox-root css-1wl1iil iconify iconify--clarity" 
          width="1em" 
          height="1em" 
          preserveAspectRatio="xMidYMid meet" 
          viewBox="0 0 36 36">
          <path 
              [ngStyle]="{'fill': isDropdownVisible ? 'rgb(33, 150, 243)' : 'currentColor'}" 
              d="M32.51 27.83A14.4 14.4 0 0 1 30 24.9a12.6 12.6 0 0 1-1.35-4.81v-4.94A10.81 10.81 0 0 0 19.21 4.4V3.11a1.33 1.33 0 1 0-2.67 0v1.31a10.81 10.81 0 0 0-9.33 10.73v4.94a12.6 12.6 0 0 1-1.35 4.81a14.4 14.4 0 0 1-2.47 2.93a1 1 0 0 0-.34.75v1.36a1 1 0 0 0 1 1h27.8a1 1 0 0 0 1-1v-1.36a1 1 0 0 0-.34-.75M5.13 28.94a16.2 16.2 0 0 0 2.44-3a14.2 14.2 0 0 0 1.65-5.85v-4.94a8.74 8.74 0 1 1 17.47 0v4.94a14.2 14.2 0 0 0 1.65 5.85a16.2 16.2 0 0 0 2.44 3Z" 
              class="clr-i-outline clr-i-outline-path-1">
          </path>
          <path 
              [ngStyle]="{'fill': isDropdownVisible ? 'rgb(33, 150, 243)' : 'currentColor'}" 
              d="M18 34.28A2.67 2.67 0 0 0 20.58 32h-5.26A2.67 2.67 0 0 0 18 34.28" 
              class="clr-i-outline clr-i-outline-path-2">
          </path>
          <path fill="none" d="M0 0h36v36H0z"></path>
      </svg>
            <span class="BaseBadge-badge BaseBadge-invisible MuiBadge-badge MuiBadge-standard MuiBadge-invisible MuiBadge-anchorOriginTopRight MuiBadge-anchorOriginTopRightRectangular MuiBadge-overlapRectangular MuiBadge-colorError css-1kr17ld">0</span></span>
          <span class="MuiTouchRipple-root css-w0pj6f">
  
          </span>
        </button>
        <span *ngIf="unreadNotificationCount > 0" class="custom-badge">
          {{ unreadNotificationCount }}
        </span>             <div *ngIf="isDropdownVisible" class="css-1oknx5t" tabindex="-1" style="opacity: 1; transform: none; transition: opacity 228ms cubic-bezier(0.4, 0, 0.2, 1), transform 152ms cubic-bezier(0.4, 0, 0.2, 1); top: 50px; margin-left: -316px !important;  transform-origin: 360px 0px;">
          <span class="arrow css-98b6ta">
  
          </span>
          <div class="css-3sojac" >
            <div class="css-i9gxme">
              <h6 class="css-k9tjo5">Notifications</h6>
             
              <ng-container *ngIf="notifications.length > 0; else noNotifications" >
            <div class="notification-list">
                    <div *ngFor="let notification of notifications" class="dropdown-item" [class.unread]="!notification.isRead"
                         [ngStyle]="{ 'background-color': notification.isRead ? 'transparent' : '#d0dde9' }">
                        <p class="css-11r9ii4" [ngStyle]="{
                            'color': notification.isRead === false ? 'black' : 'black'}">{{ notification.message }}</p>
                        <div [ngStyle]="{
                            'position': 'absolute',
                            'bottom': '0',
                            'left': '0',
                            'width': '100%',
                            'height': '3px',
                            'background-color': notification.isRead ? 'transparent' : 'white'
                        }"></div>
                  </div>
                  </div>
            </ng-container>
  
              <ng-template #noNotifications>
                <p class="css-11r9ii4">Vous avez 0 notifications</p>
              </ng-template>
             
            </div>
          </div>
          
        </div>
  </div>
  
  
  <div class="popover-wrapper"  >
  
                <button (click)="toggleDropdown()" class="css-w5qhhs" tabindex="0" type="button"><div class="css-1ciwozm"><img alt="photoURL" [src]="userPhotoUrl" class="css-1hy9t21"></div><span [ngStyle]="{
                  'background-color': showDropdown ? 'rgba(0, 0, 0, 0.6)' : 'transparent'
              }"class="css-w0pj6f"></span></button>
              
                <div *ngIf="showDropdown" class="popover-container" tabindex="-1">
                  <span class="arrow css-98b6ta"></span>
                                  <div class="popover-content">
                    <h6 class="title">{{users.user.nomUser}} {{users.user.prenomUser}}</h6>
                    <p class="email">{{users.user.emailUser}}</p>
                  </div>
                  <hr class="divider">
                  <div class="menu">
                    <a routerLink="/projects" class="menu-item">
                      <div class="menu-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-1wit1pw iconify iconify--icons8" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill="currentColor" d="M12 5v8h3v2H5v4H2v8h8v-8H7v-2h8v2h-3v8h8v-8h-3v-2h8v2h-3v8h8v-8h-3v-4H17v-2h3V5zm2 2h4v4h-4zM4 21h4v4H4zm10 0h4v4h-4zm10 0h4v4h-4z"></path></svg>                    </div>
                      Projets
                    </a>
                    <a routerLink="/profil" class="menu-item">
                      <div class="menu-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-1wit1pw iconify iconify--ant-design" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 1024 1024"><path fill="currentColor" d="M858.5 763.6a374 374 0 0 0-80.6-119.5a375.6 375.6 0 0 0-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1c-.4.2-.8.3-1.2.5c-44.8 18.9-85 46-119.5 80.6a375.6 375.6 0 0 0-80.6 119.5A371.7 371.7 0 0 0 136 901.8a8 8 0 0 0 8 8.2h60c4.4 0 7.9-3.5 8-7.8c2-77.2 33-149.5 87.8-204.3c56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 0 0 8-8.2c-1-47.8-10.9-94.3-29.5-138.2M512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362s17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362s-17.9 89.1-50.4 121.6S557.9 534 512 534"></path></svg>                    </div>
                      Profile
                    </a>
                  </div>
                  <hr class="divider">
                  <li (click)="logout()" class="menu-item logout">
                    <div class="menu-icon">
                      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-12z0wuy iconify iconify--ic" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M5 5h7V3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h7v-2H5zm16 7l-4-4v3H9v2h8v3z"></path></svg>                  </div>
                    Déconnexion
                  </li>
                </div>
                
  
              </div>
              
              
              
                  </div>
           
        
          </div>  
        
        </div>
            </div>
  

            <!------------partie comment--------------------->
            <div class="chat-container" *ngIf="showComments">
              <div class="messages">
                <div *ngFor="let commentaire of commentaires" class="message">
                  <div class="message-header">
                    <div style="display: flex; align-items: center;">
                      <img [src]="commentaire.user.imageUser" class="avatar" alt="User Avatar">
                      <div class="username">
                        <span *ngIf="isCurrentUser(commentaire)">Vous</span>
                        <span *ngIf="!isCurrentUser(commentaire)">{{ commentaire.user.nomUser }}</span>
                      </div>
                     </div>
                    <div class="timestamp">{{ formatDate(commentaire.dateDeCommentaire) }}</div>
                  </div>
                  <div *ngIf="commentaire.file && (commentaire.file.endsWith('.mp3') || commentaire.file.endsWith('.mpg'))">
                    <audio controls class="audio">
                      <source [src]="commentaire.audioUrl" type="audio/mpeg">
                      Votre navigateur ne prend pas en charge la lecture audio.
                    </audio>
                  </div>
            
                
                <p *ngIf="commentaire.file && (commentaire.file.endsWith('.pdf') || commentaire.file.endsWith('.docx'))" 
                style="padding: 0.5rem; border: 1px solid rgb(204, 204, 204); margin: 1rem 0;">
                <a href="javascript:void(0)" (click)="openFile(commentaire.file)">{{ commentaire.file }}</a>
             </p>
            
             <div *ngIf="commentaire.imageUrl && 
             (commentaire.imageUrl.endsWith('.jpg') || commentaire.imageUrl.endsWith('.jpeg') || commentaire.imageUrl.endsWith('.png') || commentaire.imageUrl.endsWith('.gif') || commentaire.imageUrl.endsWith('.bmp') ||  commentaire.imageUrl.endsWith('.webp'))">
            <img class="imgcomment" 
            [src]="commentaire.imageUrl" alt="file" style="margin: 1rem 0px; width: 100%; height: 5rem; object-fit: contain;">
            </div>
             <p *ngIf="!commentaire.file">{{ commentaire.contenu }}</p>
                </div>
              </div>
              
              <form class="input-container" (ngSubmit)="creatCommentaire()">
                <ng-container *ngIf="file; else attachFileButton">
                  <button  class="css-vox4nh" tabindex="0" type="button" id="attachement-modal">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-9uy14h iconify iconify--carbon" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32">
                      <path fill="currentColor" d="M30.94 15.66A16.69 16.69 0 0 0 16 5A16.69 16.69 0 0 0 1.06 15.66a1 1 0 0 0 0 .68A16.69 16.69 0 0 0 16 27a16.69 16.69 0 0 0 14.94-10.66a1 1 0 0 0 0-.68M16 25c-5.3 0-10.9-3.93-12.93-9C5.1 10.93 10.7 7 16 7s10.9 3.93 12.93 9C26.9 21.07 21.3 25 16 25"></path>
                      <path fill="currentColor" d="M16 10a6 6 0 1 0 6 6a6 6 0 0 0-6-6m0 10a4 4 0 1 1 4-4a4 4 0 0 1-4 4"></path>
                    </svg>
                  </button>
                </ng-container>
              
                <ng-template #attachFileButton>
                  <button type="button" (click)="openDialog()">
                    <span class="material-icons">attach_file</span>
                  </button>
                </ng-template>
                <input type="text" [(ngModel)]="contenu" placeholder="Type a message..." name="contenu" required>
                <button type="submit">
                  <span class="material-icons send">send</span>
                </button>
              </form>
              
            </div>


      <!------------partie canvas--------------------->

    <div class="items-bmc" [ngClass]="{'narrow': showComments}">
      <div class="item-bmc" *ngIf="blocks  && blocks?.length > 0" >
        <div *ngIf="shouldDisplayMesg()"> <p class="css-tq1709" >Enregistré <mat-icon>done</mat-icon></p></div>   
          <div>
            <div class="icon-container" [ngClass]="{'shift-left': showComments , 'narrow': currentBlockIndex === 12}">
              <span class="tooltip" *ngIf="!showComments">voir les commentaires</span> 
              <button (click)="toggleComments()"  class="css-1tb287z" [ngClass]="{'narrow': showComments}" tabindex="0" type="button">
                <span class="css-1rzb3uu"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="css-9uy14h iconify iconify--codicon" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16">
                  <path fill="currentColor" d="M14.5 2h-13l-.5.5v9l.5.5H4v2.5l.854.354L7.707 12H14.5l.5-.5v-9zm-.5 9H7.5l-.354.146L5 13.293V11.5l-.5-.5H2V3h12z">
  
                  </path>
                </svg>
  </span>
  <span class="css-w0pj6f"></span>
  </button>
  <span  class="badge1" *ngIf="commentCount > 0">{{ commentCount }}</span>

   </div>
            <mat-stepper *ngIf="userRole?.roleInvite === 'editor'" #stepper class="demo-stepper"  (selectionChange)="onStepChange($event)" >
              <mat-step >            
                <p class="css-vgwlcw">Etape 1: {{blocks[0].nomBlock}}</p>
                <div class="css-igeghr">{{blocks[0].description}}</div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 2: {{blocks[1].nomBlock}}</p>
                <div class="MuiBox-root css-igeghr">{{blocks[1].description}}</div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 3: {{blocks[2].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">{{blocks[2].description}}</div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 4: {{blocks[3].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                  {{blocks[3].description}}
               </div>
              </mat-step>
               <mat-step>            
                <p class="css-vgwlcw">Etape 5: {{blocks[4].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">{{blocks[4].description}}
                </div>
              </mat-step>
               <mat-step>            
                <p class="css-vgwlcw">Etape 6: {{blocks[5].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                   {{blocks[5].description}}
                </div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 7: {{blocks[6].nomBlock}}</p>
                <div class="MuiBox-root css-igeghr">              
                  {{blocks[6].description}}
                </div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 8: {{blocks[7].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                  {{blocks[7].description}}
    
                </div>
              </mat-step>
              <mat-step >            
                <p *ngIf="!showTable && userRole?.roleInvite === 'editor'" class="css-vgwlcw">Etape 9: {{blocks[8].nomBlock}} </p>
                <div *ngIf="!showTable && userRole?.roleInvite === 'editor'" class="MuiBox-root css-igeghr">
                  {{blocks[8].description}}
    
                </div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 10: {{blocks[9].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                  {{blocks[9].description}}
    
                </div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 11: {{blocks[10].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                  {{blocks[10].description}}
    
                </div>
              </mat-step>
              <mat-step>            
                <p class="css-vgwlcw">Etape 12: {{blocks[11].nomBlock}} </p>
                <div class="MuiBox-root css-igeghr">
                  {{blocks[11].description}}
    
                </div>
              </mat-step>
              <mat-step >            
                <p  class="css-vgwlcw">Etape 13 </p>
                <div  class="MuiBox-root css-igeghr">
                 Sommaire
    
                </div>
              </mat-step>
            </mat-stepper>
        </div>
         <div class="css-1tfsht7"> 
          <div  class="css-9bzmof" *ngIf="!showTable && userRole?.roleInvite === 'editor'">
            <div class="container" style="margin-right: auto; margin-left: auto; padding-right: 15px; padding-left: 15px; max-height: 350px; overflow-y: auto;">
              <div class="notes-list" style="width: 112%; display: grid; grid-template-columns: 1fr 1fr 1fr;">
                <form [formGroup]="donneesForm" *ngIf="showAddButton && donnees?.length < 6">
                  <div class="MuiBox-root css-4xg6x2" title="Ajouter un post-it" (click)="creatColor()">
                    <mat-icon>add</mat-icon>
                  </div>
                </form>
                
                <div [style.backgroundColor]="donnees?.coleur " class="note MuiBox-root css-1sdqa4j" (click)="toggleDeleteButton(donnees)" *ngFor="let donnees of donnees">
                  <div >
                    <div *ngIf="showDeleteButton && isSelectedDonnee(donnees)" class="note-action MuiBox-root css-cpm1aj">
                      <button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1m32rbj" tabindex="0" type="button">
                        <svg  style=" position: absolute;top: 0; left: 0;" (click)="toggleFormVisibility(donnees.idDonnees)" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img"
                          class="MuiBox-root css-3o0h5k iconify iconify--akar-icons" sx="[object Object]" width="1em" height="1em"
                          preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24">
                          <g fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="4" cy="12" r="1"></circle>
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="20" cy="12" r="1"></circle>
                          </g>
                        </svg>
                        
                        <form (click)="toggleFormVisibility(donnees.idDonnees)"*ngIf="isFormVisibleForItemId(donnees.idDonnees)" class="color-form">

                        <ng-container  *ngFor="let group of groupColors(generatedColors)">
                          <div  class="color-group">
                            <div class="circle" *ngFor="let color of group" [style.background-color]="color"  (click)="updateColor(donnees.idDonnees, color)"></div>
                          </div>
                        </ng-container>
                        <svg (click)="openPopup(donnees.idDonnees)" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                          <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/>
                        </svg> 
                        <span class="MuiTouchRipple-root css-w0pj6f"></span>
                      </form>

                      </button>
                    </div>
                    <form [formGroup]="donneesForms" >
                      <textarea
                      (keydown.enter)="onEnterKey($event)"
                      (input)="updateTicketValue($event)"
                      (keyup.enter)="updatedonne(donnees.idDonnees)"
                      (blur)="updatedonne(donnees.idDonnees)"

                      maxlength="150"
                      style="color: inherit; background: transparent; border: none; outline: none; height: 100%; width: 100%; resize: none; font-family: inherit; font-size: inherit; font-weight: inherit; font-style: inherit; word-break: break-word;"
                    >{{ donnees.ticket}}</textarea>
                    
                    </form>
                    
                  </div>
                  
                </div>
                
                
                
              
              </div>
          
            </div>
              
                     </div>
            <div class="wrapper" *ngIf="!showTable && userRole?.roleInvite === 'editor'">
              <div class="canvas"  [ngClass]="{ 'narrow': showComments }">
                <div id="canvas-key-problem" class="segment" (click)="detectedBlockById(blocks[2].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[2].idBlock) }" (click)="toggleSelection(blocks[2].idBlock)">
                <div class="segment-header-key"><span>Probléme</span>	<mat-icon>lock</mat-icon></div>
                <div *ngFor="let donnee of blocks[2]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[2]?.donnees?.length > 1">
                  <p>+{{ blocks[2]?.donnees?.length - 1 }} </p>
                </div>
                </div>
                <div id="canvas-key-existing" class="segment" (click)="detectedBlockById(blocks[3].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[3].idBlock) }" (click)="toggleSelection(blocks[3].idBlock)">
                  <div class="segment-header-key"><span>Alternatives existantes </span><mat-icon> check</mat-icon>
                </div>
                <div *ngFor="let donnee of blocks[3]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[3]?.donnees?.length > 1">
                  <p>+{{ blocks[3]?.donnees?.length - 1 }} </p>
                </div>
              </div>
                <div id="canvas-key-activities" class="segment" (click)="detectedBlockById(blocks[4].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[4].idBlock) }" (click)="toggleSelection(blocks[4].idBlock)">
                  <div class="segment-header-key"><span>Solution </span> <mat-icon> vpn_key</mat-icon>
                  </div>
                  <div *ngFor="let donnee of blocks[4]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                    <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                  <div *ngIf="blocks[4]?.donnees?.length > 1">
                    <p>+{{ blocks[4]?.donnees?.length - 1 }} </p>
                  </div>
                </div>              
                <div id="canvas-key-resources" class="segment" (click)="detectedBlockById(blocks[9].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[9].idBlock) }" (click)="toggleSelection(blocks[9].idBlock)">
                  <div class="segment-header-key"><span>Indicateurs de performance </span><mat-icon> insert_chart_outlined</mat-icon>
                </div>
                <div *ngFor="let donnee of blocks[9]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[9]?.donnees?.length > 1">
                  <p>+{{ blocks[9]?.donnees?.length - 1 }} </p>
                </div>
              </div>
                <div id="canvas-customer-relationships" class="segment" (click)="detectedBlockById(blocks[5].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[5].idBlock) }" (click)="toggleSelection(blocks[5].idBlock)">
                  <div class="segment-header-key"><span>Proposition de valeur unique</span><mat-icon>card_giftcard</mat-icon>
                  
                  </div>
                  <div *ngFor="let donnee of blocks[5]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                    <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                  <div *ngIf="blocks[5]?.donnees?.length > 1">
                    <p>+{{ blocks[5]?.donnees?.length - 1 }} </p>
                  </div>
                </div>
                <div id="canvas-concept" class="segment" (click)="detectedBlockById(blocks[6].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[6].idBlock) }" (click)="toggleSelection(blocks[6].idBlock)"><div class="segment-header-key"><span>{{blocks[6].nomBlock}}</span>
                  <mat-icon>find_in_page</mat-icon>
                </div>
                <div *ngFor="let donnee of blocks[6]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[6]?.donnees?.length > 1">
                  <p>+{{ blocks[6]?.donnees?.length - 1 }} </p>
                </div>
              </div>
                <div id="canvas-customer-adv" class="segment" (click)="detectedBlockById(blocks[7].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[7].idBlock) }" (click)="toggleSelection(blocks[7].idBlock)">
                  <div class="segment-header-key"><span>Avantage compétitif</span><mat-icon>thumb_up</mat-icon>
                  </div>
                  <div *ngFor="let donnee of blocks[7]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                    <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                  <div *ngIf="blocks[7]?.donnees?.length > 1">
                    <p>+{{ blocks[7]?.donnees?.length - 1 }} </p>
                  </div>
                </div>
                <div id="canvas-channels" class="segment" (click)="detectedBlockById(blocks[8].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[8].idBlock) }" (click)="toggleSelection(blocks[8].idBlock)">
                  <div class="segment-header-key"><span>Canaux</span>
                  <mat-icon>find_in_page</mat-icon>
                </div>
                <div *ngFor="let donnee of blocks[8]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[8]?.donnees?.length > 1">
                  <p>+{{ blocks[8]?.donnees?.length - 1 }} </p>
                </div>
              </div>
                <div id="canvas-customer-segments" class="segment" (click)="detectedBlockById(blocks[0].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[0].idBlock) }" (click)="toggleSelection(blocks[0].idBlock)">
                  <div class="segment-header-key"><span>Segments de clientèles</span>	<mat-icon>group</mat-icon>
                  
                  </div>
                  <div *ngFor="let donnee of blocks[0]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                    <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                  <div *ngIf="blocks[0]?.donnees?.length > 1">
                    <p>+{{ blocks[0]?.donnees?.length - 1 }} </p>
                  </div>                </div>
                <div id="canvas-customer-early" class="segment"(click)="detectedBlockById(blocks[1].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[1].idBlock) }" (click)="toggleSelection(blocks[1].idBlock)"><div class="segment-header-key"><span>Utilisateurs pionniers</span><mat-icon>king_bed</mat-icon>
                </div>
                <div *ngFor="let donnee of blocks[1]?.donnees?.slice(0, 1)" style="padding: 5px 10px; display: flex; flex-direction: column;">
                  <div [style.backgroundColor]="donnee?.coleur" class="MuiBox-root css-kqsxjs">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
                <div *ngIf="blocks[1]?.donnees?.length > 1">
                  <p>+{{ blocks[1]?.donnees?.length - 1 }} </p>
                </div>
              </div>
                <div id="canvas-cost-structure" class="segment" (click)="detectedBlockById(blocks[10].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[10].idBlock) }" (click)="toggleSelection(blocks[10].idBlock)"><div class="segment-header-key"><span>Coûts</span><mat-icon> local_offer</mat-icon>
                
                </div>
              
                <div style="display: flex;">
                  <div *ngFor="let donnee of blocks[10]?.donnees?.slice(0, 3); let i = index" 
                       [style.backgroundColor]="donnee?.coleur" 
                       class="kqsxjs1" 
                       [style.width]="calculateWidth(blocks[10]?.donnees?.length)"
                       [style.marginRight]="i < 2 ? '5px' : '0'">
                    <p>{{donnee.ticket}}</p>
                  </div>
                
                  <div *ngIf="blocks[10]?.donnees?.length > 3" class="additional-section">
                    <p>+{{ blocks[10]?.donnees?.length - 3 }} </p>
                  </div>
                </div>
              </div>
                <div id="canvas-revenue-streams" class="segment" (click)="detectedBlockById(blocks[11].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[11].idBlock) }" (click)="toggleSelection(blocks[11].idBlock)"><div class="segment-header-key"><span>Sources de revenus</span> <mat-icon>attach_money 
                </mat-icon></div>
              
                <div style="padding: 5px 10px; display: flex;">
                  <div *ngFor="let donnee of blocks[11]?.donnees?.slice(0, 3); let i = index" 
                       [style.backgroundColor]="donnee?.coleur" 
                       class="kqsxjs1" 
                       [style.width]="calculateWidth(blocks[11]?.donnees?.length)"
                       [style.marginRight]="i < 2 ? '5px' : '0'">
                    <p>{{donnee.ticket}}</p>
                  </div>
                
                  <div *ngIf="blocks[11]?.donnees?.length > 3" class="additional-section">
                    <p>+{{ blocks[11]?.donnees?.length - 3 }} </p>
                  </div>
                </div>
              </div>
              </div>   
            </div>


            <div  class="wrapper" *ngIf="showTable && userRole?.roleInvite === 'editor' || userRole?.roleInvite === 'moniteur' " >
              <div class="button-container">
                <button *ngIf="showTable ||userRole?.roleInvite === 'moniteur' " (click)="telechargerPDF()" class="css-1dq7v2u button-spacing" tabindex="0" type="button" title="Télécharger votre canvas en format pdf" textcolor="primary" value="8" id="mui-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-1cqkbll iconify iconify--carbon" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill="currentColor" d="M24 24v4H8v-4H6v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4Z"></path><path fill="currentColor" d="m21 21l-1.414-1.414L17 22.172V14h-2v8.172l-2.586-2.586L11 21l5 5zm7-17V2h-6v10h2V8h3V6h-3V4zm-11 8h-4V2h4a3.003 3.003 0 0 1 3 3v4a3.003 3.003 0 0 1-3 3m-2-2h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-2zM9 2H4v10h2V9h3a2.003 2.003 0 0 0 2-2V4a2 2 0 0 0-2-2M6 7V4h3l.001 3z"></path></svg><span class="MuiTouchRipple-root css-w0pj6f"></span></button>
                <button *ngIf="showTable && userRole?.roleInvite === 'editor'" class="css-lt70pb button-spacing" tabindex="0" type="submit"  (click)="openPopupInvite()">Envoyer une invitation<span class="MuiButton-endIcon MuiButton-iconSizeMedium css-pt151d"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-0 iconify iconify--cib" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill="currentColor" d="m29.919 6.163l-4.225 19.925c-.319 1.406-1.15 1.756-2.331 1.094l-6.438-4.744l-3.106 2.988c-.344.344-.631.631-1.294.631l.463-6.556L24.919 8.72c.519-.462-.113-.719-.806-.256l-14.75 9.288l-6.35-1.988c-1.381-.431-1.406-1.381.288-2.044l24.837-9.569c1.15-.431 2.156.256 1.781 2.013z"></path></svg></span><span class="MuiTouchRipple-root css-w0pj6f"></span></button>
              </div>        
              <br>    
               <div class="canvas1"  [ngClass]="{'narrow': showComments}"  id="table" id='tableau'>
                <div id="canvas-key-problem" class="segment" (click)="detectedBlockById(blocks[2].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[2].idBlock) }" (click)="toggleSelection(blocks[2].idBlock)">
                <div class="segment-header-key"><span>Probléme</span>	<mat-icon>lock</mat-icon></div>
                  <div class="conteneur">
                    <div *ngFor="let donnee of blocks[2]?.donnees; let i = index" class="kqsxjs1"
                    [style.backgroundColor]="donnee?.coleur" 
                         [style.width]="calculateWidth3(blocks[2]?.donnees?.length, i)"
                         [style.marginRight]="i < 7 ? '2px' : '0'">
                         
                      <p>{{donnee.ticket}}</p>
                    </div>
              
                </div>
                </div>
                <div id="canvas-key-existing" class="segment" (click)="detectedBlockById(blocks[3].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[3].idBlock) }" (click)="toggleSelection(blocks[3].idBlock)">
                  <div class="segment-header-key"><span>Alternatives existantes </span><mat-icon> check</mat-icon>
                </div>
                <div class="conteneur">
                  <div *ngFor="let donnee of blocks[3]?.donnees; let i = index" class="kqsxjs1"
                  [style.backgroundColor]="donnee?.coleur" 
                       [style.width]="calculateWidth3(blocks[3]?.donnees?.length, i)"
                       [style.marginRight]="i < 7 ? '2px' : '0'">
                       
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
              </div>
                <div id="canvas-key-activities" class="segment" (click)="detectedBlockById(blocks[4].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[4].idBlock) }" (click)="toggleSelection(blocks[4].idBlock)">
                  <div class="segment-header-key"><span>Solution </span> <mat-icon> vpn_key</mat-icon>
                  </div>
                  <div class="conteneur">
                    <div *ngFor="let donnee of blocks[4]?.donnees; let i = index" class="kqsxjs1"
                    [style.backgroundColor]="donnee?.coleur" 
                         [style.width]="calculateWidth3(blocks[4]?.donnees?.length, i)"
                         [style.marginRight]="i < 7 ? '2px' : '0'">
                         
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                </div>              
                <div id="canvas-key-resources" class="segment" (click)="detectedBlockById(blocks[9].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[9].idBlock) }" (click)="toggleSelection(blocks[9].idBlock)">
                  <div class="segment-header-key"><span>Indicateurs de performance </span><mat-icon> insert_chart_outlined</mat-icon>
                </div>
                <div class="conteneur">
                  <div *ngFor="let donnee of blocks[9]?.donnees; let i = index" class="kqsxjs1"
                  [style.backgroundColor]="donnee?.coleur" 
                       [style.width]="calculateWidth3(blocks[9]?.donnees?.length, i)"
                       [style.marginRight]="i < 7 ? '2px' : '0'">
                       
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
              </div>
                <div id="canvas-customer-relationships" class="segment" (click)="detectedBlockById(blocks[5].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[5].idBlock) }" (click)="toggleSelection(blocks[5].idBlock)">
                  <div class="segment-header-key"><span>Proposition de valeur unique</span><mat-icon>card_giftcard</mat-icon>
                  
                  </div>
                  <div class="conteneur">
                    <div *ngFor="let donnee of blocks[5]?.donnees; let i = index" class="kqsxjs1"
                    [style.backgroundColor]="donnee?.coleur" 
                         [style.width]="calculateWidth3(blocks[5]?.donnees?.length, i)"
                         [style.marginRight]="i < 7 ? '2px' : '0'">
                         
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                </div>
                <div id="canvas-concept" class="segment" (click)="detectedBlockById(blocks[6].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[6].idBlock) }" (click)="toggleSelection(blocks[6].idBlock)"><div class="segment-header-key"><span>{{blocks[6].nomBlock}}</span>
                  <mat-icon>find_in_page</mat-icon>
                </div>
                <div class="conteneur">
                  <div *ngFor="let donnee of blocks[6]?.donnees; let i = index" class="kqsxjs1"
                  [style.backgroundColor]="donnee?.coleur" 
                       [style.width]="calculateWidth3(blocks[6]?.donnees?.length, i)"
                       [style.marginRight]="i < 7 ? '2px' : '0'">
                       
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
              </div>
                <div id="canvas-customer-adv" class="segment" (click)="detectedBlockById(blocks[7].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[7].idBlock) }" (click)="toggleSelection(blocks[7].idBlock)">
                  <div class="segment-header-key"><span>Avantage compétitif</span><mat-icon>thumb_up</mat-icon>
                  </div>
                  <div class="conteneur">
                    <div *ngFor="let donnee of blocks[7]?.donnees; let i = index" class="kqsxjs1"
                    [style.backgroundColor]="donnee?.coleur" 
                         [style.width]="calculateWidth3(blocks[7]?.donnees?.length, i)"
                         [style.marginRight]="i < 7 ? '2px' : '0'">
                         
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                </div>
                <div id="canvas-channels" class="segment" (click)="detectedBlockById(blocks[8].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[8].idBlock) }" (click)="toggleSelection(blocks[8].idBlock)">
                  <div class="segment-header-key"><span>Canaux</span>
                  <mat-icon>find_in_page</mat-icon>
                </div>
                <div class="conteneur">
                  <div *ngFor="let donnee of blocks[8]?.donnees; let i = index" class="kqsxjs1"
                  [style.backgroundColor]="donnee?.coleur" 
                       [style.width]="calculateWidth3(blocks[8]?.donnees?.length, i)"
                       [style.marginRight]="i < 7 ? '2px' : '0'">
                       
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
              </div>
                <div id="canvas-customer-segments" class="segment" (click)="detectedBlockById(blocks[0].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[0].idBlock)&& userRole?.roleInvite !== 'moniteur' }" (click)="toggleSelection(blocks[0].idBlock)">
                  <div class="segment-header-key"><span>Segments de clientèles</span>	<mat-icon>group</mat-icon>
                  
                  </div>
                  <div class="conteneur">
                    <div *ngFor="let donnee of blocks[0]?.donnees; let i = index" class="kqsxjs1"
                    [style.backgroundColor]="donnee?.coleur" 
                         [style.width]="calculateWidth3(blocks[0]?.donnees?.length, i)"
                         [style.marginRight]="i < 7 ? '2px' : '0'">
                         
                      <p>{{donnee.ticket}}</p>
                    </div>
                  </div>
                                 </div>
                <div id="canvas-customer-early" class="segment"(click)="detectedBlockById(blocks[1].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[1].idBlock) }" (click)="toggleSelection(blocks[1].idBlock)"><div class="segment-header-key"><span>Utilisateurs pionniers</span><mat-icon>king_bed</mat-icon>
                </div>
                <div class="conteneur">
                  <div *ngFor="let donnee of blocks[1]?.donnees; let i = index" class="kqsxjs1"
                  [style.backgroundColor]="donnee?.coleur" 
                       [style.width]="calculateWidth3(blocks[1]?.donnees?.length, i)"
                       [style.marginRight]="i < 7 ? '2px' : '0'">
                       
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
              </div>
                <div id="canvas-cost-structure" class="segment" (click)="detectedBlockById(blocks[10].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[10].idBlock) }" (click)="toggleSelection(blocks[10].idBlock)"><div class="segment-header-key"><span>Coûts</span><mat-icon> local_offer</mat-icon>
                
                </div>
              
                <div style="display: flex;">
                  <div *ngFor="let donnee of blocks[10]?.donnees; let i = index" 
                       [style.backgroundColor]="donnee?.coleur" 
                       class="kqsxjs1" 
                       [style.width]="calculateWidth2(blocks[10]?.donnees?.length)"
                       [style.marginRight]="i < 7 ? '5px' : '0'">
                    <p>{{donnee.ticket}}</p>
                  </div>
                </div>
            
              </div>
                <div id="canvas-revenue-streams" class="segment" (click)="detectedBlockById(blocks[11].idBlock)" [ngClass]="{ 'selected': isSelected(blocks[11].idBlock) }" (click)="toggleSelection(blocks[11].idBlock)"><div class="segment-header-key"><span>Sources de revenus</span> <mat-icon>attach_money 
                </mat-icon></div>
              
                <div style=" display: flex;">
                  <div *ngFor="let donnee of blocks[11]?.donnees; let i = index" 
                       [style.backgroundColor]="donnee?.coleur" 
                       class="kqsxjs1" 
                       [style.width]="calculateWidth2(blocks[11]?.donnees?.length)"
                       [style.marginRight]="i < 7 ? '5px' : '0'">
                    <p>{{donnee.ticket}}</p>
                  </div>
                
                  <div *ngIf="blocks[11]?.donnees?.length > 3" class="additional-section">
                    <p>+{{ blocks[11]?.donnees?.length - 3 }} </p>
                  </div>
                </div>
              </div>
              </div>   
            </div>
         
      </div> 
      <br>
      <div class="css-1xto6kq" [ngClass]="{'narrow': donnees?.length >2}">
        <button class="css-5357ut" *ngIf="shouldDisplayButton()"
        tabindex="0" 
        type="button" 
        (click)="precedent()" 
        [disabled]="userRole?.roleInvite === 'moniteur' || currentBlockIndex === 0">
    Précédent
    <span class="css-w0pj6f"></span>
    </button>
            <div class="css-11qjisw" >
            </div> 
            <button *ngIf="shouldDisplayButton()"class="css-ivnzlx"  tabindex="0" type="button" (click)="suivant()">
              {{ currentBlockIndex === 11 ? 'Terminer' : 'Suivant' }}
              <span class="css-w0pj6f"></span>
    
            </button>
         
    </div>
      </div>
     
    </div>
  </div>
  </div>
  <button *ngIf="showTable && userRole?.roleInvite !== 'moniteur'" class="css-5357ut"  style="position: relative;top: 307px;"(click)="precedent()" >Précédent</button>

  <div class="centered-message" *ngIf="userRole?.roleInvite === null">
    <p>tu n'as pas le droit dans cette canvas. Attendre une invitation ou contacter le Porteur de projet.</p>
  </div>