
<div class="css-1byr0tz ">
  
    <div class="header">

        <div class="navbar">
          <div class="css-1ir47a1">
            <a routerLink="/projects" class="no-underline">
              <h2 class="logo"><span style="color: rgb(33, 150, 243)">Canvas</span></h2>
            </a>    <div class="MuiBox-root css-i9gxme"></div>
            <div class="css-1x4nai">
              <div class="dropdown-container">

<mat-icon class="maticon2" 
[matMenuTriggerFor]="notificationsMenu" (click)="toggleDropdown1()">
  notifications
</mat-icon>
<mat-badge [matBadge]="unreadNotificationCount"  [matBadgeHidden]="unreadNotificationCount === 0" matBadgeColor="accent" matBadgePosition="above after"></mat-badge>

<mat-menu #notificationsMenu="matMenu" class="notifications-menu">
  <div class="menu-container">
    <div *ngIf="notifications.length > 0; else noNotifications" >
      <button mat-menu-item *ngFor="let notification of notifications" class="dropdown-item" 
        [ngStyle]="{ 'background-color':notification.isRead ?'transparent': '#d0dde9' }">
        <div 
        [ngStyle]="{
          

          'position': 'absolute',
          'bottom': '0',
          'left': '0',
          'width': '100%',
          'height': '3px', 
          'background-color': notification.isRead ?'transparent': 'white' 
        
      }">
    </div>
        <p class="invite">{{ notification.message }}</p>
      </button>
    </div>
    <ng-template #noNotifications>
      <button mat-menu-item disabled>
        Aucune notification à afficher.
      </button>
    </ng-template>
  </div>
</mat-menu>



              </div>
                <mat-icon 
              routerLink="/chat" 
              class="maticon1" 
              matBadge="{{ messageCount }}" 
              matBadgeColor="warn" 
              matBadgePosition="above after" 
              [matBadgeHidden]="messageCount === 0"> 
              chat
            </mat-icon>
            

      

        <div class="dropdown-container">
          <mat-icon class="maticons" (click)="togglePendingInvitesDropdown()">email</mat-icon>
        
          <div *ngIf="pendingInvitesCount > 0" class="badge">{{ pendingInvitesCount }}</div>
        
          <div class="dropdown-content" *ngIf="showPendingInvitesDropdown">
            <ng-container *ngIf="pendingInvites && pendingInvites.length > 0; else noInvites">
              <div *ngFor="let invite of pendingInvites" class="dropdown-item" (click)="openPopup1(invite.idInvite)">
                <p class="invite">Vous avez une Invitation dans <br><strong>{{ invite.canvas.nomCanvas}}</strong> de projet <strong>{{ invite.projet.nomProjet }}</strong></p>
              </div>
            </ng-container>
            <ng-template #noInvites>
              <div class="dropdown-item">
                <p class="no-invite">Aucune invitation en attente.</p>
              </div>
            </ng-template>
          

          </div>
        </div>
        
              <div class="dropdown-container">
                <mat-icon  (click)="toggleDropdown()">
                  <img class="circular-image" [src]="userPhotoUrl" alt="User Photo">
                </mat-icon>
              
                <div class="dropdown-content" *ngIf="showDropdown">
                  <div (click)="logout()" class="dropdown-item">
                    <mat-icon>logout</mat-icon> <p class="mat">Deconnexion</p>
                  </div>
                  <div routerLink="/profil"  class="dropdown-item">
                    <mat-icon>settings</mat-icon> <p class="mat">Paramétre</p>
                  </div>
                </div>
              </div>
              
              
              
                  </div>
           
        
          </div>  
        
        </div>
            </div>  <div class="css-1byr0tz">
    
      <div class="MuiBox-root css-0">
          <div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2">
              <h4 class="MuiTypography-root MuiTypography-h4 css-sko12q">Mes Projets</h4>
              <div class="MuiTypography-root MuiTypography-p css-yq9a6z">Choisissez un projet ou créez-en un nouveau.</div>
          <div class="list-project">
         <div style="width: 100%;">
          <div class="css-isbt42">
              <div class="createproject"  (click)="openCreate()">        
                     
                          <mat-icon>add</mat-icon>  
                                
           </div>
           <div  class="css-z5duxk"  *ngFor="let project of projects "> 
             
              <div class="css-mm5vp">
                  
                  <div class="container">
                      <div><img *ngIf="projectImages[project.idProjet]" [src]="projectImages[project.idProjet]" alt="Project Image" class="small-image">
                          <!-- Use ngIf to ensure the image is only displayed when available -->
                          <span *ngIf="!projectImages[project.idProjet]">Image Loading...</span></div>
                  </div> 
                      <div>
                      <button type="button"  (click)="openDelete(project.idProjet)" class="css-mwubz9"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-0 iconify iconify--bi" sx="[object Object]" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="currentColor"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"></path><path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"></path></g></svg>
                      </button>
                 
                  </div>
             <div >
                  <div class="projectInfo">
                    <div class="role" >
                     Projet
                      </div>
                      
                      
                      
                      <div class="nomproject">{{project.nomProjet}}</div></div>
  <div >
    <div class="progress-container">
        <div class="progress-bar" [style.width.%]="projectProgress[project.idProjet]">
        </div>
    </div>
    
    
    
  </div>
  </div>         
                  <div class="buttons">
                    <button (click)="saveProjectId(project.idProjet)" [routerLink]="['/canvas']" class="css-1ybokyr" tabindex="0" type="button">
                      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-1xlzgj9 iconify iconify--codicon"  height="1em" viewBox="0 0 16 16">
                          <path fill="currentColor" d="M13.5 2h-12l-.5.5v11l.5-.5h12l.5-.5v-11zM2 3h11v1H2zm7 4H6V5h3zm0 1v2H6V8zM2 5h3v2H2zm0 3h3v2H2zm0 5v-2h3v2zm4 0v-2h3v2zm7 0h-3v-2h3zm0-3h-3V8h3zm-3-3V5h3v2z"></path>
                      </svg>
                      <div class="textbutton">Canvas</div>
                  </button>
                  
                      <button class="css-1ybokyr" tabindex="0" type="button">
                          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="MuiBox-root css-1xlzgj9 iconify iconify--akar-icons" sx="[object Object]" height="1em" viewBox="0 0 24 24">
                              <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 6s1.5-2 5-2s5 2 5 2v14s-1.5-1-5-1s-5 1-5 1zm10 0s1.5-2 5-2s5 2 5 2v14s-1.5-1-5-1s-5 1-5 1z"></path>
                          </svg>
                          <div class="textbutton">Business Plan</div>
                          
                      </button>
                  </div></div> 
                  </div>
                  </div>
                  </div>
         <div></div>
           <div></div>
           <div></div>
          </div>
         
          </div>
      </div>  
      
  </div>
  </div>
     
  <dialog *ngIf="showPopup" class="popup-container" (click)="closeDialog($event)">
       <div class="popup" (click)="preventClose($event)">
      <p class="titre">Nouveau projet</p>
      <form  [formGroup]="projectForm" (ngSubmit)="onSubmit()"> 
      <div class="inputpopup">
      
     <div> <input class="inputtitre" placeholder="Dénomination social du projet" formControlName="nomProjet" ></div>
     <div class="inputphtoto">
     <div>
      <input type="file" class="image" id="fileInput" style="display: none;" formControlName="image" (change)="onFileSelected($event)" >
      <label for="fileInput" class="fileInputLabel">
          <img  [src]="projectForm.get('image')?.value ? getImageSrc(projectForm.get('image')!.value) :  getImageSrc(projectForm.get('image')?.value)" alt="Selected file" height="200rem">
      </label>
  </div>
  </div>
  </div>
      <button type="submit" class="ajouter" >Ajouter</button>
  </form>
  </div></dialog>
  
  
  <dialog *ngIf="showPopupdelte" class="popup-container-delete" > 
      <div class="popup-delete" (click)="preventClose($event)">
          <div>
      <p class="titredelete">Voulez-vous vraiment supprimer ce projet ?</p>
      <p class="warning">Cette action est irréversible</p>
          </div>
      
      <div class="buttondete">
      <button (click)="closeDeletePopup()" class="annuler">Annuler</button>
      <button (click)="onDelete()" class="suppr">Supprimer</button>
       </div>
  
  </div></dialog>